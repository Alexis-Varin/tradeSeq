<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Evaluate the optimal number of knots required for fitGAM. — evaluateK • tradeSeq</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Evaluate the optimal number of knots required for fitGAM. — evaluateK" />

<meta property="og:description" content="Evaluate the optimal number of knots required for fitGAM." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tradeSeq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.38</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tradeSeq.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Evaluate the optimal number of knots required for fitGAM.</h1>
    
    <div class="hidden name"><code>evaluateK.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Evaluate the optimal number of knots required for fitGAM.</p>
    
    </div>

    <pre class="usage"><span class='fu'>evaluateK</span>(<span class='no'>counts</span>, <span class='kw'>U</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='no'>pseudotime</span>, <span class='no'>cellWeights</span>, <span class='kw'>nGenes</span> <span class='kw'>=</span> <span class='fl'>500</span>,
  <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>3</span>:<span class='fl'>10</span>, <span class='kw'>weights</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>seed</span> <span class='kw'>=</span> <span class='fl'>81</span>, <span class='kw'>offset</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>ncores</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>aicDiff</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>bicDiff</span> <span class='kw'>=</span> <span class='fl'>2</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>counts</th>
      <td><p>the count matrix.</p></td>
    </tr>
    <tr>
      <th>U</th>
      <td><p>the design matrix of fixed effects. The design matrix should not
contain an intercept to ensure identifiability.</p></td>
    </tr>
    <tr>
      <th>pseudotime</th>
      <td><p>a matrix of pseudotime values, each row represents a cell
and each column represents a lineage.</p></td>
    </tr>
    <tr>
      <th>cellWeights</th>
      <td><p>a matrix of cell weights defining the probability that a
cell belongs to a particular lineage. Each row represents a cell and each
column represents a lineage.</p></td>
    </tr>
    <tr>
      <th>nGenes</th>
      <td><p>The number of genes to use in the evaluation. Genes will be
randomly selected. 500 by default.</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>The range of knots to evaluate. `3:10` by default.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>Optional: a matrix of weights with identical dimensions
as the <code>counts</code> matrix. Usually a matrix of zero-inflation weights.</p></td>
    </tr>
    <tr>
      <th>seed</th>
      <td><p>Optional: the seed used for assigning cells to lineages.</p></td>
    </tr>
    <tr>
      <th>offset</th>
      <td><p>Optional: the offset, on log-scale. If NULL, TMM is used to
account for differences in sequencing depth, see <code>fitGAM</code>.</p></td>
    </tr>
    <tr>
      <th>ncores</th>
      <td><p>Number of cores to use.</p></td>
    </tr>
    <tr>
      <th>aicDiff</th>
      <td><p>Used for selecting genes with significantly varying AIC values
over the range of evaluated knots to make the barplot output. Default is set
to 2, meaning that only genes whose AIC range is larger than 2 will be used
to check for the optimal number of knots through the barplot visualization
that is part of the output of this function.</p></td>
    </tr>
    <tr>
      <th>bicDiff</th>
      <td><p>Used for selecting genes with significantly varying BIC values
over the range of evaluated knots to make the barplot output. Default is set
to 2, meaning that only genes whose BIC range is larger than 2 will be used
to check for the optimal number of knots through the barplot visualization
that is part of the output of this function.
<code><a href='https://www.rdocumentation.org/packages/edgeR/topics/calcNormFactors'>edgeR::calcNormFactors</a></code>. Alternatively, this may also be a matrix of
the same dimensions as the expression matrix.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A plot of average AIC value over the range of selected knots, and a
matrix of AIC values for the selected genes (rows) and the range of knots
(columns).</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Random'>set.seed</a></span>(<span class='fl'>8</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/download.file'>download.file</a></span>(<span class='st'>"https://github.com/statOmics/tradeSeqPaper/raw/master/data/se_paul.rda"</span>,
<span class='kw'>destfile</span><span class='kw'>=</span><span class='st'>"./se_paul.rda"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/load'>load</a></span>(<span class='st'>"./se_paul.rda"</span>)
<span class='no'>se</span> <span class='kw'>&lt;-</span> <span class='no'>se</span>[( <span class='fl'>20</span>:<span class='fl'>31</span>)[-<span class='fl'>7</span>], <span class='fl'>25</span>:<span class='fl'>40</span>]
<span class='no'>pseudotimes</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>se</span>) * <span class='fl'>2</span>, <span class='fl'>0</span>, <span class='fl'>5</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>cellWeights</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Uniform'>runif</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>se</span>) * <span class='fl'>2</span>, <span class='fl'>0</span>, <span class='fl'>1</span>), <span class='kw'>ncol</span> <span class='kw'>=</span> <span class='fl'>2</span>)
<span class='no'>gamList</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='fitGAM.html'>fitGAM</a></span>(<span class='kw'>counts</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(
                      <span class='kw pkg'>SummarizedExperiment</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>assays</a></span>(<span class='no'>se</span>)$<span class='no'>counts</span>),
                  <span class='kw'>pseudotime</span> <span class='kw'>=</span> <span class='no'>pseudotimes</span>, <span class='kw'>cellWeights</span> <span class='kw'>=</span> <span class='no'>cellWeights</span>,
                  <span class='kw'>nknots</span> <span class='kw'>=</span> <span class='fl'>5</span>)
<span class='no'>aicK</span> <span class='kw'>&lt;-</span> <span class='fu'>evaluateK</span>(<span class='kw'>counts</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>as.matrix</a></span>(
                      <span class='kw pkg'>SummarizedExperiment</span><span class='kw ns'>::</span><span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>assays</a></span>(<span class='no'>se</span>)$<span class='no'>counts</span>),
                  <span class='kw'>pseudotime</span> <span class='kw'>=</span> <span class='no'>pseudotimes</span>, <span class='kw'>cellWeights</span> <span class='kw'>=</span> <span class='no'>cellWeights</span>,
                  <span class='kw'>nGenes</span><span class='kw'>=</span><span class='fl'>100</span>, <span class='kw'>k</span><span class='kw'>=</span><span class='fl'>3</span>:<span class='fl'>5</span>, <span class='kw'>ncores</span><span class='kw'>=</span><span class='fl'>2</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Koen Van den Berge, Hector Roux de Bézieux.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

